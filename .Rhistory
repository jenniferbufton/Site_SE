knitr::opts_chunk$set(echo = TRUE)
library(class)
library(gmodels)
library(rlang)
library(caret)
library(extrafont)
library(leaflet)
library(ggplot2)
library(dplyr)
library(extrafont)
library(leaflet)
library(scales)
library(knitr)
library(tidyverse)
library(forcats)
library(wordcloud2)
#### read in GMS data
setwd("C:/Users/jenniferb/OneDrive - Sport England/GitHub/Small Grants")
sg_df <- read.csv('SG_all.csv', header = TRUE, na.strings = c("","N/A"))
topic_tbl <- read.csv('12Month_top.csv') %>%
rename("Topic" = Topic.id, "Terms" = Concatenate.Term.)
text_df <- read.csv('12Month_Prog.csv', header = TRUE)
sentiment_df <- read.csv('Sentiment.csv', header = TRUE)%>%
select("Document", "Sentiment.Prediction", "all.Words") %>%
rename("Sentiment" = Sentiment.Prediction, `Number of Words` = "all.Words")
# colours for charts
se_colour<- c("#E79AB5", "#B8345C", "#8CCDD6", "#43A8B6", "#00818F", "#C1DC9A", "#7ABB40", "#5D4086")
# transformation for headline figs
sp_vec <- sg_df %>% count(Sport, sort = TRUE)
sp_per <- sp_vec[1,2] / sum(sp_vec$n) * 100
sp_per <- unlist(sp_per)
sp_org <- sg_df %>% count(ORGANISATION_NAME, sort = TRUE)
sp_org$Times_funded <- ifelse(sp_org$n > 1, "More than once", "Once")
sp_la <- sg_df%>% count(LOCAL_AUTHORITY, sort = TRUE)
sp_fo <- sg_df%>% count(Focus, sort = TRUE)
sp_la_imd <- sg_df[order(sg_df$IMD_RANK),]
sent_tab <- table(sentiment_df$Sentiment)
ggplot(sg_df)+
stat_boxplot(aes(x = "", y = AWARD), stat = , color = "#5D4086")+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(sg_df)+
stat_boxplot(aes(x = "", y = AWARD) , color = "#5D4086")+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(sg_df)+
stat_boxplot(aes(x = "", y = AWARD) , fill = "#5D4086")+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(sg_df)+
geom_boxplot(aes(x = "", y = AWARD) , fill = "#5D4086")+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(sg_df)+
geom_boxplot(aes(x = "", y = AWARD) , fill = "#5D4086", outlier.colour =  "#5D4086")+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(sg_df)+
geom_boxplot(aes(x = "", y = AWARD) , color = "#5D4086", outlier.colour =  "#5D4086", )+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "left")  +
scale_color_manual(values = se_colour, name = "Focus")+
labs( x= "", y = "Amount Awarded", title = "Funding Amount")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data= sg_df, aes(x= Sport, y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Number of Awards", title = "Type of Sport by Number of Awards")
ggplot(data= sg_df, aes(x= reorder(Sport, AWARD), y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Number of Awards", title = "Type of Sport by Number of Awards")
ggplot(data = sg_df, aes(x= Org_Class, y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data = sg_df, aes(x= reorder(Org_Class, AWARD), y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data = sg_df, aes(x= reorder(Org_Class, -AWARD), y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data = sg_df, aes(x= Org_Class, -AWARD, y = AWARD))+
geom_bar(stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data = sg_df)+
geom_bar( aes(x= reorder(Org_Class, -AWARD), y = AWARD)stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
ggplot(data = sg_df)+
geom_bar(aes(x= reorder(Org_Class, -AWARD), y = AWARD), stat = "identity", fill = "#5D4086") +
coord_flip()+
theme(text = element_text(family = "Norwester", size = 12, color = "#525252"),
plot.title=element_text(size=14,family = "Norwester", face="bold", hjust = 0.5, color = "#525252"),
axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
axis.text.y = element_text(hjust = 1, size = 8),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.caption=element_text(size=9, hjust=0, margin=margin(15,0,0,0)),
legend.position = "right") +
labs( x= "Organisation type", y = "Award amount", title = "Awards Amount by Organisation Type")+
scale_y_continuous(labels = scales::dollar_format(prefix = "£"))
setwd("C:/Users/jenniferb/OneDrive - Sport England/GitHub/Small Grants")
sg_df <- read.csv('SG_all.csv', header = TRUE, na.strings = c("","N/A"))
colnames(sg_df)
setwd("C:/Users/jenniferb/OneDrive - Sport England/GitHub/Small Grants")
sg_df <- read.csv('SG_all.csv', header = TRUE, na.strings = c("","N/A"))
colnames(sg_df)
setwd("C:/Users/jenniferb/OneDrive - Sport England/GitHub/Small Grants")
sg_df <- read.csv('SG_all.csv', header = TRUE, na.strings = c("","N/A"))
colnames(sg_df)
table_df <- sg_df %>%
rename("URN" = GMS_URN, `Award Amount` =  AWARD, `Total Project Cost` = Total_Project_Cost,  `Partnership Funding` = Partnership_Funding, `Other Funding` = OTHER_FUNDING, `Government Outcome` = Govt_Outcome, "Region" = GOVERNMENT_OFFICE_REGION, `Organisation Type`= Org_Class, `IMD Decile` = "IMD_Decile_2019", `Active Lives Survey Inactive (%)` = ALS_Inactive_PC_2018, `Total Population` = Population..2018.Estimates....Total.population.) %>%
select(c(`Award Amount`, `Total Project Cost`, "Sport", "Region", `Organisation Type`, "Focus"))
summary(table_df)
